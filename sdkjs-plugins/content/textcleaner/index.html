<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Text Cleaner</title>
  <script type="text/javascript" src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.js"></script>
  <script type="text/javascript" src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins-ui.js"></script>
  <link rel="stylesheet" href="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.css">
  <script type="text/javascript" src="scripts/textcleaner.js"></script>
  <style>
    .app-container {
      height: 100%;
      overflow: hidden;
    }
    .main-container {
      display: flex;
      flex-direction: column;
      height: 100%;
      max-height: 100vh;
    }
    .scroll-container {
      flex: 1;
      overflow-y: auto;
      padding: 0 16px;
    }
    .header {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 15px;
      text-align: center;
      position: sticky;
      top: 0;
      padding: 10px 0;
      background: white;
      z-index: 10;
      border-bottom: 1px solid #e0e0e0;
    }
    .section {
      margin-bottom: 15px;
    }
    .section-title {
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 8px;
    }
    .option {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
    }
    .help-text {
      font-size: 11px;
      margin-top: 4px;
      margin-left: 20px;
      opacity: 0.7;
    }
    .instructions {
      font-size: 12px;
      margin-bottom: 15px;
      padding: 10px;
      background-color: #f5f5f5;
      border-radius: 4px;
    }
    .select-all-container {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      padding: 8px;
      background-color: #f0f0f0;
      border-radius: 4px;
    }
    .format-tools {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-bottom: 15px;
      padding: 8px;
      border: 1px solid #e0e0e0;
      border-radius: 4px;
    }
    .format-tool {
      margin-right: 5px;
    }
    .disabled {
      opacity: 0.5;
      pointer-events: none;
    }
    /* custom toggle switch */
    .switch {
      position:relative;display:inline-block;width:34px;height:18px;margin-right:8px;
    }
    .switch input {opacity:0;width:0;height:0;}
    .slider {
      position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#2f2f2f;border-radius:34px;transition:.2s;
    }
    .slider:before{
      position:absolute;content:"";height:14px;width:14px;left:2px;bottom:2px;background:white;border-radius:50%;transition:.2s;
    }
    input:checked + .slider {background:#00b458;}
    input:checked + .slider:before{transform:translateX(16px);}
  </style>
</head>
<body class="asc-plugin-body">
  <div class="app-container">
    <div class="main-container">
      <div class="scroll-container">
        <div class="asc-plugin-container">
          <div class="header">Text Cleaner</div>
          
          <div class="instructions">
            This plugin helps you clean and format text in your document. Select text to clean only that portion, or clean the entire document if no text is selected.
          </div>
          
          <div class="select-all-container">
            <label class="switch">
              <input type="checkbox" id="select-all-options" checked>
              <span class="slider"></span>
            </label>
            <label for="select-all-options" class="asc-plugin-text">
              <strong>All parameters</strong>
            </label>
          </div>
          
          <div class="section asc-plugin-block">
            <!-- Accordion header -->
            <button class="btn-text-default link acc-head" data-target="#acc-clear" style="width:100%;text-align:left;">
              Clear Formatting <span style="float:right;">&#9662;</span>
            </button>
            <!-- Accordion body -->
            <div id="acc-clear" class="asc-collapse" style="display:block;padding-top:8px;">
              <div class="option">
                <input type="checkbox" id="remove-multiple-spaces" checked>
                <label for="remove-multiple-spaces" class="asc-plugin-text">Remove multiple spaces</label>
              </div>
              <div class="help-text">Converts multiple spaces in text to a single space.</div>
              
              <div class="option">
                <input type="checkbox" id="remove-line-breaks">
                <label for="remove-line-breaks" class="asc-plugin-text">Remove line breaks</label>
              </div>
              <div class="help-text">Converts line breaks in text to a single space.</div>
              
              <div class="option">
                <input type="checkbox" id="remove-trailing-spaces" checked>
                <label for="remove-trailing-spaces" class="asc-plugin-text">Remove trailing spaces</label>
              </div>
              <div class="help-text">Removes spaces at the beginning and end of paragraphs.</div>
              
              <div class="option">
                <input type="checkbox" id="remove-tabs">
                <label for="remove-tabs" class="asc-plugin-text">Remove tabs</label>
              </div>
              <div class="help-text">Converts tab characters to spaces.</div>
            </div>
          </div>
          
          <div class="section asc-plugin-block">
            <div class="section-title">Text Formatting</div>
            <div class="option">
              <input type="checkbox" id="replace-quotes">
              <label for="replace-quotes" class="asc-plugin-text">Fix quotation marks</label>
            </div>
            <div class="help-text">Replaces straight quotes ("") with typographic quotes ("").</div>
            
            <div class="option">
              <input type="checkbox" id="fix-punctuation">
              <label for="fix-punctuation" class="asc-plugin-text">Fix punctuation</label>
            </div>
            <div class="help-text">Removes spaces before punctuation marks and adds spaces after them.</div>
            
            <div class="option">
              <input type="checkbox" id="remove-empty-paragraphs">
              <label for="remove-empty-paragraphs" class="asc-plugin-text">Remove empty paragraphs</label>
            </div>
            <div class="help-text">Cleans up empty paragraphs in the document.</div>
            
            <div class="option">
              <input type="checkbox" id="fix-casing">
              <label for="fix-casing" class="asc-plugin-text">Fix casing</label>
            </div>
            <div class="help-text">Capitalizes first letter of sentences.</div>
          </div>
          
          <div class="section asc-plugin-block">
            <div class="section-title">Advanced</div>
            <div class="option">
              <input type="checkbox" id="normalize-dashes">
              <label for="normalize-dashes" class="asc-plugin-text">Normalize dashes</label>
            </div>
            <div class="help-text">Converts different dash characters to standard dashes.</div>
            
            <div class="option">
              <input type="checkbox" id="normalize-spaces">
              <label for="normalize-spaces" class="asc-plugin-text">Normalize Unicode spaces</label>
            </div>
            <div class="help-text">Converts different types of Unicode space characters to standard spaces.</div>
            
            <div class="option">
              <input type="checkbox" id="normalize-numbers">
              <label for="normalize-numbers" class="asc-plugin-text">Normalize numbers</label>
            </div>
            <div class="help-text">Converts special number formats (fractions, superscripts) to standard format.</div>
          </div>
          
          <div class="section asc-plugin-block">
            <div class="section-title">Format Tools</div>
            <div class="format-tools">
              <button id="font-bold" class="btn-text-default format-tool" title="Bold">B</button>
              <button id="font-italic" class="btn-text-default format-tool" title="Italic">I</button>
              <button id="font-underline" class="btn-text-default format-tool" title="Underline">U</button>
              <button id="font-strikeout" class="btn-text-default format-tool" title="Strikethrough">S</button>
              <button id="text-caps" class="btn-text-default format-tool" title="All Caps">AA</button>
              
              <div style="display: flex; align-items: center; margin-left: 5px;">
                <button id="text-color" class="btn-text-default format-tool" title="Text color">A</button>
                <input type="color" id="text-color-picker" style="width: 20px; height: 20px; margin-left: 3px;">
              </div>
              
              <div style="display: flex; align-items: center; margin-left: 5px;">
                <button id="font-family" class="btn-text-default format-tool" title="Font">F</button>
                <select id="font-family-select" style="margin-left: 3px; height: 22px;">
                  <option value="Arial">Arial</option>
                  <option value="Times New Roman">Times New Roman</option>
                  <option value="Calibri">Calibri</option>
                </select>
              </div>
              
              <div style="display: flex; align-items: center; margin-left: 5px;">
                <button id="font-size" class="btn-text-default format-tool" title="Font size">Aa</button>
                <select id="font-size-select" style="margin-left: 3px; height: 22px; width: 40px;">
                  <option value="8">8</option>
                  <option value="10">10</option>
                  <option value="12">12</option>
                  <option value="14">14</option>
                  <option value="16">16</option>
                  <option value="18">18</option>
                  <option value="20">20</option>
                  <option value="24">24</option>
                </select>
              </div>
            </div>
          </div>
          
          <div class="button-container" style="text-align:center;margin-top:10px;">
            <button id="clean-button" class="btn-text-default submit primary" style="width:100px;">Temizle</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Select All functionality
    document.getElementById('select-all-options').addEventListener('change', function() {
      const isChecked = this.checked;
      const checkboxes = document.querySelectorAll('input[type="checkbox"]:not(#select-all-options)');
      checkboxes.forEach(cb => cb.checked = isChecked);
    });
    
    // Clean button click -> trigger Asc plugin button 0
    document.getElementById('clean-button').addEventListener('click', () => {
      if (window.Asc && window.Asc.plugin && typeof window.Asc.plugin.button === 'function') {
        window.Asc.plugin.button(0);
      }
    });
  </script>
  <script>
    // Accordion toggle
    document.querySelectorAll('.acc-head').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const target = document.querySelector(btn.dataset.target);
        if(!target) return;
        const isOpen = target.style.display !== 'none';
        // close all
        document.querySelectorAll('.asc-collapse').forEach(c=>c.style.display='none');
        // toggle selected
        target.style.display = isOpen ? 'none':'block';
      });
    });
  </script>
</body>
</html> 